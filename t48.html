<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arc Astra - Admin Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #1a2a4a 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .header h1 {
            font-size: 36px;
            color: #00ffff;
            margin-bottom: 5px;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .header p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }
        
        /* Login Box */
        .login-box {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 20px;
            padding: 40px;
            max-width: 450px;
            margin: 100px auto;
            box-shadow: 0 10px 50px rgba(0, 255, 255, 0.2);
        }
        
        .login-box h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #00ffff;
        }
        
        .login-box input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .login-box input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }
        
        .login-box button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #00ffff, #00cccc);
            border: none;
            border-radius: 10px;
            color: #0a1628;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .login-box button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
        }
        
        /* Dashboard */
        .dashboard {
            display: none;
        }
        
        .logout-btn {
            position: absolute;
            top: 0;
            right: 20px;
            padding: 12px 24px;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-radius: 10px;
            color: #ff6b6b;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
        }
        
        .logout-btn:hover {
            background: rgba(255, 107, 107, 0.3);
            transform: translateY(-2px);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(0, 255, 255, 0.2);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 24px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .tab:hover {
            background: rgba(0, 255, 255, 0.1);
            color: white;
        }
        
        .tab.active {
            background: rgba(0, 255, 255, 0.2);
            border-color: #00ffff;
            color: #00ffff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        }
        
        .stat-card h3 {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-card .number {
            font-size: 48px;
            color: #00ffff;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        /* Tables */
        .data-table {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 25px;
            overflow-x: auto;
        }
        
        .data-table h2 {
            color: #00ffff;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        th {
            color: #00ffff;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
        }
        
        tr:hover {
            background: rgba(0, 255, 255, 0.05);
        }
        
        /* Loading */
        .loading {
            text-align: center;
            color: #00ffff;
            font-size: 18px;
            margin: 40px 0;
        }
        
        .spinner {
            border: 4px solid rgba(0, 255, 255, 0.1);
            border-left-color: #00ffff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Error */
        .error {
            color: #ff6b6b;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 10px;
        }
        
        /* Search & Filter */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .controls input,
        .controls select,
        .controls button {
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 14px;
        }
        
        .controls button {
            background: linear-gradient(135deg, #00ffff, #00cccc);
            color: #0a1628;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .controls button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.4);
        }
        
        /* User Card */
        .user-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            transition: all 0.3s;
        }
        
        .user-card:hover {
            border-color: #00ffff;
            transform: translateX(5px);
        }
        
        .user-field {
            display: flex;
            flex-direction: column;
        }
        
        .user-field label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 3px;
            text-transform: uppercase;
        }
        
        .user-field span {
            color: #00ffff;
            font-weight: bold;
        }
        
        /* Chart Container */
        .chart-container {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container h2 {
            color: #00ffff;
            margin-bottom: 20px;
        }
        
        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .badge.active {
            background: rgba(0, 255, 127, 0.2);
            color: #00ff7f;
            border: 1px solid rgba(0, 255, 127, 0.3);
        }
        
        .badge.inactive {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .pagination button {
            padding: 10px 20px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            color: #00ffff;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .pagination button:hover:not(:disabled) {
            background: rgba(0, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .pagination button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .pagination span {
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Box -->
        <div id="loginBox" class="login-box">
            <h2>üîí Admin Panel Giri≈üi</h2>
            <input type="password" id="adminPassword" placeholder="Admin ≈ûifresi" autocomplete="current-password">
            <button onclick="login()">Giri≈ü Yap</button>
            <div id="errorMsg" class="error" style="display: none;"></div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="header">
                <h1>üîí Arc Astra Admin Panel</h1>
                <p>Sistem ƒ∞statistikleri ve Y√∂netim</p>
                <button class="logout-btn" onclick="logout()">√áƒ±kƒ±≈ü Yap</button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('overview')">üìä Genel Bakƒ±≈ü</div>
                <div class="tab" onclick="switchTab('users')">üë• Kullanƒ±cƒ±lar</div>
                <div class="tab" onclick="switchTab('countries')">üåç √úlkeler</div>
                <div class="tab" onclick="switchTab('levels')">‚≠ê Seviyeler</div>
            </div>

            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="loading" id="overviewLoading">
                    <div class="spinner"></div>
                    <p>ƒ∞statistikler y√ºkleniyor...</p>
                </div>
                <div id="overviewContent" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Toplam Kullanƒ±cƒ±</h3>
                            <div class="number" id="totalUsers">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Aktif Kullanƒ±cƒ± (48s)</h3>
                            <div class="number" id="activeUsers">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Aktiflik Oranƒ±</h3>
                            <div class="number" id="activeRate">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Toplam Balance</h3>
                            <div class="number" id="totalBalance">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Toplam Mined</h3>
                            <div class="number" id="totalMined">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Ortalama Balance</h3>
                            <div class="number" id="avgBalance">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users Tab -->
            <div id="users" class="tab-content">
                <div class="data-table">
                    <h2>üë• Kullanƒ±cƒ± Listesi</h2>
                    <div class="controls">
                        <input type="text" id="searchUser" placeholder="Kullanƒ±cƒ± ara..." onkeyup="filterUsers()">
                        <button onclick="loadUsers()">üîÑ Yenile</button>
                        <button onclick="exportUsers()">üì• Dƒ±≈üa Aktar</button>
                    </div>
                    <div class="loading" id="usersLoading" style="display: none;">
                        <div class="spinner"></div>
                        <p>Kullanƒ±cƒ±lar y√ºkleniyor...</p>
                    </div>
                    <div id="usersContent"></div>
                    <div class="pagination" id="usersPagination"></div>
                </div>
            </div>

            <!-- Countries Tab -->
            <div id="countries" class="tab-content">
                <div class="data-table">
                    <h2>üåç √úlke ƒ∞statistikleri</h2>
                    <div class="loading" id="countriesLoading">
                        <div class="spinner"></div>
                        <p>√úlke verileri y√ºkleniyor...</p>
                    </div>
                    <div id="countriesContent"></div>
                </div>
            </div>

            <!-- Levels Tab -->
            <div id="levels" class="tab-content">
                <div class="data-table">
                    <h2>‚≠ê Seviye Daƒüƒ±lƒ±mƒ±</h2>
                    <div class="loading" id="levelsLoading">
                        <div class="spinner"></div>
                        <p>Seviye verileri y√ºkleniyor...</p>
                    </div>
                    <div id="levelsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            adminPassword: 'arcastra2025admin',
            apiEndpoint: 'https://europe-west1-arcastra.cloudfunctions.net',
            apiEndpoints: {
                getAdminStats: '/getAdminStats',
                getAllUsers: '/getAllUsers',
                updateUserBalance: '/updateUserBalance'
            }
        };

        let cachedData = {
            stats: null,
            users: [],
            currentPage: 0,
            usersPerPage: 20
        };

        // Login
        function login() {
            const password = document.getElementById('adminPassword').value;
            const errorMsg = document.getElementById('errorMsg');
            
            if (!password) {
                errorMsg.textContent = 'L√ºtfen ≈üifre girin';
                errorMsg.style.display = 'block';
                return;
            }
            
            if (password !== CONFIG.adminPassword) {
                errorMsg.textContent = 'Hatalƒ± ≈üifre!';
                errorMsg.style.display = 'block';
                return;
            }
            
            document.getElementById('loginBox').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            loadAdminStats();
        }

        // Logout
        function logout() {
            document.getElementById('loginBox').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            document.getElementById('errorMsg').style.display = 'none';
            cachedData = { stats: null, users: [], currentPage: 0, usersPerPage: 20 };
        }

        // Switch Tab
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Load data if needed
            if (tabName === 'users' && cachedData.users.length === 0) {
                loadUsers();
            } else if (tabName === 'countries') {
                displayCountries();
            } else if (tabName === 'levels') {
                displayLevels();
            }
        }

        // Load Admin Stats
        async function loadAdminStats() {
            try {
                document.getElementById('overviewLoading').style.display = 'block';
                document.getElementById('overviewContent').style.display = 'none';
                
                const response = await fetch(CONFIG.apiEndpoint + CONFIG.apiEndpoints.getAdminStats, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ adminPassword: CONFIG.adminPassword })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                cachedData.stats = data;
                
                // Display stats
                document.getElementById('totalUsers').textContent = data.totalUsers.toLocaleString();
                document.getElementById('activeUsers').textContent = data.activeUsers.toLocaleString();
                document.getElementById('activeRate').textContent = 
                    ((data.activeUsers / data.totalUsers) * 100).toFixed(1) + '%';
                document.getElementById('totalBalance').textContent = 
                    data.totalBalance.toLocaleString('tr-TR', {maximumFractionDigits: 2});
                document.getElementById('totalMined').textContent = 
                    data.totalMined.toLocaleString('tr-TR', {maximumFractionDigits: 2});
                document.getElementById('avgBalance').textContent = 
                    (data.totalBalance / data.totalUsers).toFixed(2);
                
                document.getElementById('overviewLoading').style.display = 'none';
                document.getElementById('overviewContent').style.display = 'block';
            } catch (error) {
                console.error('Error loading stats:', error);
                document.getElementById('overviewLoading').innerHTML = 
                    `<div class="error">Hata: ${error.message}<br>CORS hatasƒ± olabilir. Backend'i kontrol edin.</div>`;
            }
        }

        // Load All Users
        async function loadUsers() {
            try {
                document.getElementById('usersLoading').style.display = 'block';
                
                const response = await fetch(CONFIG.apiEndpoint + CONFIG.apiEndpoints.getAllUsers, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        adminPassword: CONFIG.adminPassword,
                        limit: 100,
                        offset: 0
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                cachedData.users = data.users;
                cachedData.currentPage = 0;
                
                displayUsers();
                document.getElementById('usersLoading').style.display = 'none';
            } catch (error) {
                console.error('Error loading users:', error);
                document.getElementById('usersLoading').innerHTML = 
                    `<div class="error">Hata: ${error.message}</div>`;
            }
        }

        // Display Users
        function displayUsers() {
            const container = document.getElementById('usersContent');
            const start = cachedData.currentPage * cachedData.usersPerPage;
            const end = start + cachedData.usersPerPage;
            const pageUsers = cachedData.users.slice(start, end);
            
            let html = '';
            pageUsers.forEach(user => {
                const isActive = user.lastMiningDate && 
                    (new Date() - new Date(user.lastMiningDate)) < (48 * 60 * 60 * 1000);
                
                html += `
                    <div class="user-card">
                        <div class="user-field">
                            <label>Kullanƒ±cƒ± Adƒ±</label>
                            <span>${user.username}</span>
                        </div>
                        <div class="user-field">
                            <label>Email</label>
                            <span>${user.email}</span>
                        </div>
                        <div class="user-field">
                            <label>Balance</label>
                            <span>${user.balance.toFixed(2)} ARCA</span>
                        </div>
                        <div class="user-field">
                            <label>Level</label>
                            <span>Level ${user.level}</span>
                        </div>
                        <div class="user-field">
                            <label>Total Mined</label>
                            <span>${user.totalMined.toFixed(2)} ARCA</span>
                        </div>
                        <div class="user-field">
                            <label>√úlke</label>
                            <span>${user.country}</span>
                        </div>
                        <div class="user-field">
                            <label>Referanslar</label>
                            <span>${user.referrals} ki≈üi</span>
                        </div>
                        <div class="user-field">
                            <label>Durum</label>
                            <span class="badge ${isActive ? 'active' : 'inactive'}">
                                ${isActive ? 'Aktif' : 'Pasif'}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updatePagination();
        }

        // Update Pagination
        function updatePagination() {
            const totalPages = Math.ceil(cachedData.users.length / cachedData.usersPerPage);
            const pagination = document.getElementById('usersPagination');
            
            pagination.innerHTML = `
                <button onclick="changePage(-1)" ${cachedData.currentPage === 0 ? 'disabled' : ''}>
                    ‚Üê √ñnceki
                </button>
                <span>Sayfa ${cachedData.currentPage + 1} / ${totalPages}</span>
                <button onclick="changePage(1)" ${cachedData.currentPage >= totalPages - 1 ? 'disabled' : ''}>
                    Sonraki ‚Üí
                </button>
            `;
        }

        // Change Page
        function changePage(direction) {
            cachedData.currentPage += direction;
            displayUsers();
        }

        // Filter Users
        function filterUsers() {
            const searchTerm = document.getElementById('searchUser').value.toLowerCase();
            
            if (!searchTerm) {
                displayUsers();
                return;
            }
            
            const filtered = cachedData.users.filter(user => 
                user.username.toLowerCase().includes(searchTerm) ||
                user.email.toLowerCase().includes(searchTerm) ||
                user.country.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('usersContent');
            let html = '';
            
            filtered.forEach(user => {
                const isActive = user.lastMiningDate && 
                    (new Date() - new Date(user.lastMiningDate)) < (48 * 60 * 60 * 1000);
                
                html += `
                    <div class="user-card">
                        <div class="user-field">
                            <label>Kullanƒ±cƒ± Adƒ±</label>
                            <span>${user.username}</span>
                        </div>
                        <div class="user-field">
                            <label>Email</label>
                            <span>${user.email}</span>
                        </div>
                        <div class="user-field">
                            <label>Balance</label>
                            <span>${user.balance.toFixed(2)} ARCA</span>
                        </div>
                        <div class="user-field">
                            <label>Level</label>
                            <span>Level ${user.level}</span>
                        </div>
                        <div class="user-field">
                            <label>Total Mined</label>
                            <span>${user.totalMined.toFixed(2)} ARCA</span>
                        </div>
                        <div class="user-field">
                            <label>√úlke</label>
                            <span>${user.country}</span>
                        </div>
                        <div class="user-field">
                            <label>Referanslar</label>
                            <span>${user.referrals} ki≈üi</span>
                        </div>
                        <div class="user-field">
                            <label>Durum</label>
                            <span class="badge ${isActive ? 'active' : 'inactive'}">
                                ${isActive ? 'Aktif' : 'Pasif'}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p style="text-align: center; color: rgba(255,255,255,0.5);">Sonu√ß bulunamadƒ±</p>';
        }

        // Display Countries
        function displayCountries() {
            if (!cachedData.stats) return;
            
            const container = document.getElementById('countriesContent');
            const countries = cachedData.stats.countries;
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>√úlke</th>
                            <th>Kullanƒ±cƒ± Sayƒ±sƒ±</th>
                            <th>Y√ºzde</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            countries.forEach((item, index) => {
                const percentage = ((item.count / cachedData.stats.totalUsers) * 100).toFixed(1);
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.country}</td>
                        <td>${item.count.toLocaleString()}</td>
                        <td>${percentage}%</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
            
            document.getElementById('countriesLoading').style.display = 'none';
        }

        // Display Levels
        function displayLevels() {
            if (!cachedData.stats) return;
            
            const container = document.getElementById('levelsContent');
            const levels = cachedData.stats.levels;
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Seviye</th>
                            <th>Kullanƒ±cƒ± Sayƒ±sƒ±</th>
                            <th>Y√ºzde</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            levels.forEach(item => {
                const percentage = ((item.count / cachedData.stats.totalUsers) * 100).toFixed(1);
                html += `
                    <tr>
                        <td>Level ${item.level}</td>
                        <td>${item.count.toLocaleString()}</td>
                        <td>${percentage}%</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
            
            document.getElementById('levelsLoading').style.display = 'none';
        }

        // Export Users to CSV
        function exportUsers() {
            if (cachedData.users.length === 0) {
                alert('Hen√ºz kullanƒ±cƒ± verisi y√ºklenmedi!');
                return;
            }
            
            let csv = 'Username,Email,Balance,Level,Total Mined,Country,Referrals,Created At\n';
            
            cachedData.users.forEach(user => {
                csv += `${user.username},${user.email},${user.balance},${user.level},${user.totalMined},${user.country},${user.referrals},${user.createdAt}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `arcastra-users-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Enter key for login
        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') login();
        });
    </script>
</body>
</html>
